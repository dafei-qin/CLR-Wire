resume_training: true
from_start: false

epochs: 20000
batch_size: 1024
lr: 0.0001
num_workers: 4
num_gpus: 8

grad_accum_every: 1
ema_update_every: 10
max_grad_norm: 1.0

val_every_epoch: 10
save_every_epoch: 50
log_every_step: 50

use_wandb_tracking: true
wandb_project_name: DIT_SIMPLE_SEGMENT
wandb_run_name: 1208_dit_segment_edge_loss

data_train:
    name: src.dataset.dataset_latent_segment.LatentDataset
    params:
        latent_dir: ../data/logan_jsons_latent_pred_closed/abc
        latent_dim: 128
        num_data: -1
        log_scale: true
        replica: 1
        max_num_surfaces: 32

data_val:
    name: src.dataset.dataset_latent_segment.LatentDataset
    params:
        latent_dir: ../data/logan_jsons_latent_pred_closed/abc_test
        latent_dim: 128
        num_data: -1
        log_scale: true
        replica: 1
        max_num_surfaces: 32


trainer:
    use_logvar: false
    prediction_type: v_prediction
    num_inference_timesteps: 50


model:
    # name: dit_v2
    name: src.dit.simple_surface_decoder_segment.SimpleSurfaceDecoder
    trainer_name: dit_v1
    checkpoint_folder: checkpoints/1208_dit_edge_loss
    checkpoint_file_name: model-267.pt
    load_ckpt: false
    params:
        input_dim: 139
        cond_dim: 192
        mem_dim: 384
        output_dim: 139
        latent_dim: 384
        num_layers: 12
        num_heads: 6
        max_num_surfaces: 32
        use_diag_memory_mask: True

vae:
    config_file: src/configs/train_vae_v1_canonical_logvar_l2norm_pred_closed.yaml

loss:
    weight_valid: 0
    weight_params: 1.0
    weight_rotations: 1.0
    weight_scales: 1.0
    weight_shifts: 1.0
    weight_original_sample: 1.0
    original_sample_start_step: 00000
    weight_sample_edges: 5.0
